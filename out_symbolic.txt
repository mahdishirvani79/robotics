P in zero coordinates is: [L2*cos(Th1)*cos(Th2) + L3*(-sin(Th2)*sin(Th3)*cos(Th1) + cos(Th1)*cos(Th2)*cos(Th3)), L2*sin(Th1)*cos(Th2) + L3*(-sin(Th1)*sin(Th2)*sin(Th3) + sin(Th1)*cos(Th2)*cos(Th3)), L2*sin(Th2) + L3*(sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))]
last W is: Matrix([[th1_p*sin(Th2)*cos(Th3) + th1_p*sin(Th3)*cos(Th2)], [-th1_p*sin(Th2)*sin(Th3) + th1_p*cos(Th2)*cos(Th3)], [th2_p + th3_p]])
last V is: Matrix([[L2*th2_p*sin(Th3)], [L2*th2_p*cos(Th3) + L3*(th2_p + th3_p)], [-L2*th1_p*cos(Th2) - L3*(-th1_p*sin(Th2)*sin(Th3) + th1_p*cos(Th2)*cos(Th3))]])
Jacobian matrix is: Matrix([[(-L2*cos(Th2) - L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3)))*sin(Th1), L2*(-sin(Th2)*sin(Th3)*cos(Th1) + cos(Th1)*cos(Th2)*cos(Th3))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2)), L3*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2))], [-(-L2*cos(Th2) - L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3)))*cos(Th1), L2*(-sin(Th1)*sin(Th2)*sin(Th3) + sin(Th1)*cos(Th2)*cos(Th3))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2)), L3*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2))], [0, L2*(sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3)), L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))], [(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2)) + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*(-sin(Th2)*sin(Th3)*cos(Th1) + cos(Th1)*cos(Th2)*cos(Th3)), sin(Th1), sin(Th1)], [(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2)) + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*(-sin(Th1)*sin(Th2)*sin(Th3) + sin(Th1)*cos(Th2)*cos(Th3)), -cos(Th1), -cos(Th1)], [(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))**2 + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))**2, 0, 0]])
Taw is: Matrix([[-(-L2*cos(Th2) - L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3)))*(500*sin(Th1)*sin(Th2)*sin(Th3) - 500*sin(Th1)*cos(Th2)*cos(Th3))*cos(Th1) + (-L2*cos(Th2) - L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3)))*(500*sin(Th2)*sin(Th3)*cos(Th1) - 500*cos(Th1)*cos(Th2)*cos(Th3))*sin(Th1) + ((-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2)) + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*(-sin(Th1)*sin(Th2)*sin(Th3) + sin(Th1)*cos(Th2)*cos(Th3)))*(-200*sin(Th1)*sin(Th2)*sin(Th3) + 200*sin(Th1)*cos(Th2)*cos(Th3)) + ((-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2)) + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*(-sin(Th2)*sin(Th3)*cos(Th1) + cos(Th1)*cos(Th2)*cos(Th3)))*(-200*sin(Th2)*sin(Th3)*cos(Th1) + 200*cos(Th1)*cos(Th2)*cos(Th3)) + (200*sin(Th2)*cos(Th3) + 200*sin(Th3)*cos(Th2))*((-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))**2 + (sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))**2)], [(-500*sin(Th2)*cos(Th3) - 500*sin(Th3)*cos(Th2))*(L2*(sin(Th2)*cos(Th3) + sin(Th3)*cos(Th2))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))) + (L2*(-sin(Th1)*sin(Th2)*sin(Th3) + sin(Th1)*cos(Th2)*cos(Th3))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2)))*(500*sin(Th1)*sin(Th2)*sin(Th3) - 500*sin(Th1)*cos(Th2)*cos(Th3)) + (L2*(-sin(Th2)*sin(Th3)*cos(Th1) + cos(Th1)*cos(Th2)*cos(Th3))*sin(Th3) + (L2*cos(Th3) + L3)*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2)))*(500*sin(Th2)*sin(Th3)*cos(Th1) - 500*cos(Th1)*cos(Th2)*cos(Th3)) - (-200*sin(Th1)*sin(Th2)*sin(Th3) + 200*sin(Th1)*cos(Th2)*cos(Th3))*cos(Th1) + (-200*sin(Th2)*sin(Th3)*cos(Th1) + 200*cos(Th1)*cos(Th2)*cos(Th3))*sin(Th1)], [L3*(-sin(Th2)*sin(Th3) + cos(Th2)*cos(Th3))*(-500*sin(Th2)*cos(Th3) - 500*sin(Th3)*cos(Th2)) + L3*(500*sin(Th1)*sin(Th2)*sin(Th3) - 500*sin(Th1)*cos(Th2)*cos(Th3))*(-sin(Th1)*sin(Th2)*cos(Th3) - sin(Th1)*sin(Th3)*cos(Th2)) + L3*(500*sin(Th2)*sin(Th3)*cos(Th1) - 500*cos(Th1)*cos(Th2)*cos(Th3))*(-sin(Th2)*cos(Th1)*cos(Th3) - sin(Th3)*cos(Th1)*cos(Th2)) - (-200*sin(Th1)*sin(Th2)*sin(Th3) + 200*sin(Th1)*cos(Th2)*cos(Th3))*cos(Th1) + (-200*sin(Th2)*sin(Th3)*cos(Th1) + 200*cos(Th1)*cos(Th2)*cos(Th3))*sin(Th1)]])
